# Project Brief: Personal Library RAG System

> **Created**: 2025-12-04
> **Updated**: 2025-12-05
> **Version**: 1.2

---

## Executive Summary

BookBrainì€ 50ê¶Œ ì´ìƒì˜ ê°œë°œ ì„œì (PDF)ì„ ì‹œë§¨í‹±+í‚¤ì›Œë“œ í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ìœ¼ë¡œ íƒìƒ‰í•˜ëŠ” ê°œì¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‹œìŠ¤í…œì´ë‹¤.

**í•µì‹¬ ê°€ì¹˜**: "ìƒê°ë‚˜ëŠ” ëŒ€ë¡œ ê²€ìƒ‰í•˜ê³ , ì •í™•í•œ ì¶œì²˜ë¥¼ ì°¾ëŠ”ë‹¤"

---

## 1. Problem Statement

### í˜„ì¬ ìƒí™© (As-Is)
- **ë‹¤ìˆ˜ì˜ ê°œë°œ ì„œì ** (50ê¶Œ ì´ìƒ, ì§€ì† ì¦ê°€ ì˜ˆì •)ì„ ìŠ¤ìº”í•˜ì—¬ PDFë¡œ ë³´ìœ 
- íŠ¹ì • ë‚´ìš©ì„ ì°¾ìœ¼ë ¤ë©´ ê° PDFë¥¼ ì—´ì–´ Ctrl+Fë¡œ í‚¤ì›Œë“œ ê²€ìƒ‰
- **ë¬¸ì œì **:
  - ì •í™•í•œ í‚¤ì›Œë“œë¥¼ ê¸°ì–µí•´ì•¼ë§Œ ê²€ìƒ‰ ê°€ëŠ¥
  - ì˜ë¯¸ ê¸°ë°˜ ê²€ìƒ‰ ë¶ˆê°€ ("ë§¤í•‘ ì„¤ì • ë°©ë²•" vs "mapping configuration")
  - ì—¬ëŸ¬ ì±…ì— ê±¸ì¹œ í¬ë¡œìŠ¤ ë ˆí¼ëŸ°ìŠ¤ ì–´ë ¤ì›€
  - ì¶œì²˜(ì–´ë–¤ ì±…, ëª‡ í˜ì´ì§€)ë¥¼ ê¸°ì–µí•˜ê¸° ì–´ë ¤ì›€

### ëª©í‘œ ìƒí™© (To-Be)
- ëª¨ë“  ì¥ì„œë¥¼ ë²¡í„° DBì— ì €ì¥í•˜ì—¬ **ì‹œë§¨í‹± ê²€ìƒ‰** ê°€ëŠ¥
- í‚¤ì›Œë“œ + ì˜ë¯¸ ê¸°ë°˜ **í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰**ìœ¼ë¡œ ì •í™•ë„ í–¥ìƒ
- ê²€ìƒ‰ ê²°ê³¼ì— **ì¶œì²˜(ì±…ëª…, í˜ì´ì§€)** ëª…í™•íˆ í‘œì‹œ
- ì›¹ UIë¥¼ í†µí•´ ì–¸ì œ ì–´ë””ì„œë“  ì ‘ê·¼ ê°€ëŠ¥

---

## 2. Project Goals

### Primary Goals

| Goal | Description | Success Metric |
|------|-------------|----------------|
| G1 | ìì—°ì–´ë¡œ ì¥ì„œ ê²€ìƒ‰ | "elasticsearch ë§¤í•‘" ê²€ìƒ‰ ì‹œ ê´€ë ¨ ë‚´ìš© ìƒìœ„ ë…¸ì¶œ |
| G2 | í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ êµ¬í˜„ | í‚¤ì›Œë“œ ì •í™• ë§¤ì¹­ + ì˜ë¯¸ ìœ ì‚¬ë„ ê²°í•© |
| G3 | ì¶œì²˜ ì¶”ì  | ê²€ìƒ‰ ê²°ê³¼ì— ì±…ëª…, ì±•í„°, í˜ì´ì§€ í‘œì‹œ |
| G4 | ì›¹ ê¸°ë°˜ ì ‘ê·¼ | ì™¸ë¶€ì—ì„œ ë¸Œë¼ìš°ì €ë¡œ ê²€ìƒ‰ ê°€ëŠ¥ |

### Secondary Goals (Future â†’ v2.0+)
- AI ìš”ì•½ ê¸°ëŠ¥ (RAG with LLM)
- LangChain/LangGraph ê¸°ë°˜ ì—ì´ì „íŠ¸
- ë…¼ë¬¸/ì•„í‹°í´ í™•ì¥

---

## 3. Version Roadmap

| Version | Codename | Focus | Key Features |
|---------|----------|-------|--------------|
| **v1.0** | Search | ê²€ìƒ‰ ì „ìš© | í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰, ì¶œì²˜ ì¶”ì , Web UI |
| **v2.0** | Brain | RAG í™•ì¥ | LLM ë‹µë³€ ìƒì„±, ëŒ€í™”í˜• Q&A |
| **v3.0** | Agent | ì—ì´ì „íŠ¸ | LangGraph ê¸°ë°˜ ë©€í‹°ìŠ¤í… ì¶”ë¡  |

```
Timeline (ê°œì¸ í”„ë¡œì íŠ¸, ìœ ì—°):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  v1.0 MVP        v1.1 Polish      v2.0 RAG
  [ê²€ìƒ‰ ê¸°ëŠ¥]      [UX ê°œì„ ]        [AI ë‹µë³€]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

---

## 4. Scope

### In Scope
- **Document Parsing API (Storm Parse)** í™œìš©í•œ PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ
- íŒŒì‹±ëœ í…ìŠ¤íŠ¸ â†’ ì²­í¬ ë¶„í•  íŒŒì´í”„ë¼ì¸
- ë²¡í„° ì„ë² ë”© ë° Chroma DB ì €ì¥
- BM25 í‚¤ì›Œë“œ ê²€ìƒ‰ êµ¬í˜„
- í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ (ë²¡í„° + BM25) í†µí•©
- Streamlit ê¸°ë°˜ ê²€ìƒ‰ UI
- Oracle Cloud (Ubuntu) ë°°í¬

### Out of Scope (v1.0)
- AI ìš”ì•½/ì±—ë´‡ ê¸°ëŠ¥ (v2.0 ê³ ë ¤)
- ëª¨ë°”ì¼ ì „ìš© ì•±
- ë‹¤ì¤‘ ì‚¬ìš©ì ì¸ì¦
- ì‹¤ì‹œê°„ PDF ì—…ë¡œë“œ (ì´ˆê¸° ë°°ì¹˜ ì²˜ë¦¬)

### Non-Goals (ëª…ì‹œì ìœ¼ë¡œ í•˜ì§€ ì•Šì„ ê²ƒ)

> ê¸°ëŠ¥ ì¶”ê°€ ìœ í˜¹ì´ ì˜¬ ë•Œ ì°¸ì¡°í•  ê¸°ì¤€ì„ 

| Category | Non-Goal | ì´ìœ  |
|----------|----------|------|
| **í˜‘ì—…** | ë‹¤ì¤‘ ì‚¬ìš©ì/ê³„ì • ê´€ë¦¬ | ê°œì¸ ì „ìš© ì‹œìŠ¤í…œ |
| **í˜‘ì—…** | ê³µìœ /ì½”ë©˜íŠ¸/í˜‘ì—… ê¸°ëŠ¥ | ë³µì¡ë„ ì¦ê°€ |
| **ì—ë””í„°** | ë¶ë§ˆí¬/í•˜ì´ë¼ì´íŠ¸ ì—ë””í„° | PDF ë·°ì–´ ì˜ì—­ ì¹¨ë²” |
| **ë…ì„œ ê´€ë¦¬** | ì½ìŒ/ì•ˆì½ìŒ ì¶”ì , ë…ì„œ ë…¸íŠ¸ | Notion ë“± ê¸°ì¡´ ë„êµ¬ í™œìš© |
| **ì™¸ë¶€ ì—°ë™** | ì†Œì…œ ê³µìœ , ì™¸ë¶€ API ì œê³µ | ê°œì¸ìš© |
| **ëª¨ë°”ì¼** | ë„¤ì´í‹°ë¸Œ ì•±, PWA ìµœì í™” | Web ìš°ì„  |
| **ìë™í™”** | ìë™ PDF ìˆ˜ì§‘/êµ¬ë§¤ ì—°ë™ | ìˆ˜ë™ ì—…ë¡œë“œë¡œ ì¶©ë¶„ |

---

## 5. Constraints & Assumptions

### Constraints

| Type | Description |
|------|-------------|
| Infrastructure | Oracle Cloud Free Tier (ARM 4 OCPU, 24GB RAM) |
| Budget | ì„ë² ë”© API ìœ ë£Œ OK (OpenAI), Document Parsing API ë¹„ìš© ë°œìƒ |
| Data | ë‹¤ìˆ˜ì˜ ê°œë°œ ì„œì  (50ê¶Œ+), í•œê¸€ ì„¤ëª… + ì˜ì–´ ì½”ë“œ í˜¼í•© |
| Timeline | ì·¨ë¯¸/í¬íŠ¸í´ë¦¬ì˜¤ ëª©ì , ê¸‰í•˜ì§€ ì•ŠìŒ |

### Assumptions
- Storm Parse APIë¡œ ê³ í’ˆì§ˆ êµ¬ì¡°í™”ëœ í…ìŠ¤íŠ¸ í™•ë³´ ê°€ëŠ¥
- ì±…ë‹¹ í‰ê·  10ë§Œ ì, 100-200 ì²­í¬ ì˜ˆìƒ
- ë‹¨ì¼ ì‚¬ìš©ì (ë³¸ì¸ë§Œ ì‚¬ìš©)
- ì±… ìˆ˜ëŠ” ê³„ì† ì¦ê°€í•  ìˆ˜ ìˆìŒ

---

## 5. Key User Scenarios

### Scenario 1: ê°œë… ê²€ìƒ‰

```
User: "elasticsearchì˜ ë§¤í•‘ì— ëŒ€í•´ì„œ ì•Œë ¤ì¤˜"
System:
  - [Elasticsearch ì‹¤ì „ ê°€ì´ë“œ] Chapter 3, p.45
    "ë§¤í•‘(Mapping)ì€ ì¸ë±ìŠ¤ì— ì €ì¥ë  ë¬¸ì„œì˜ êµ¬ì¡°ë¥¼ ì •ì˜..."
  - [ê²€ìƒ‰ ì—”ì§„ êµ¬ì¶•] Chapter 5, p.112
    "í•„ë“œ íƒ€ì…ê³¼ ë¶„ì„ê¸° ì„¤ì •ì„ í†µí•´ ë§¤í•‘ì„ êµ¬ì„±..."
```

### Scenario 2: ê¸°ìˆ  ì˜µì…˜ íƒìƒ‰

```
User: "Spring Security ì¸ì¦ ê´€ë ¨ ì˜µì…˜ ì•Œë ¤ì¤˜"
System:
  - [ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ì¸ ì•¡ì…˜] Chapter 4, p.89
    "FormLogin, OAuth2, JWT ê¸°ë°˜ ì¸ì¦ ë°©ì‹..."
  - [ì‹¤ì „ ìŠ¤í”„ë§ ë¶€íŠ¸] Chapter 12, p.301
    "SecurityFilterChain ì„¤ì • ì˜µì…˜..."
```

### Scenario 3: ì¶œì²˜ í™•ì¸

```
User: "DDDì—ì„œ Aggregate ì„¤ê³„ ì›ì¹™ì´ ì–´ë”” ë‚˜ì™€ìˆì§€?"
System:
  - [ë„ë©”ì¸ ì£¼ë„ ì„¤ê³„] Chapter 6, p.125-130
    "AggregateëŠ” ë°ì´í„° ë³€ê²½ì˜ ë‹¨ìœ„ë¡œ..."
  - [DDD Start!] Chapter 3, p.78
    "Aggregate Rootë¥¼ í†µí•´ì„œë§Œ ì ‘ê·¼..."
```

---

## 6. Risk & Cost Analysis

### 6.1 Cost Budget

> **ì›” ì˜ˆì‚° ëª©í‘œ**: $30 ì´í•˜ (API ë¹„ìš© ì¤‘ì‹¬)

| Service | Unit Cost | Estimated Usage | Monthly Cost | Notes |
|---------|-----------|-----------------|--------------|-------|
| **Storm Parse API** | ~$0.01/page | 50ê¶Œ Ã— 300p = 15,000p (ì¼íšŒì„±) | ~$150 (ì¼íšŒì„±) | ì´ˆê¸° ìˆ˜ì§‘ ì‹œì—ë§Œ ë°œìƒ |
| **OpenAI Embedding** | $0.00002/1K tokens | ~5M tokens (ì¼íšŒì„±) | ~$0.10 (ì¼íšŒì„±) | ìˆ˜ì§‘ ì‹œ + ê²€ìƒ‰ ì‹œ |
| **OpenAI Embedding (ê²€ìƒ‰)** | $0.00002/1K tokens | ~100 queries/day Ã— 100 tokens | ~$0.06/month | ì¼ìƒ ì‚¬ìš© |
| **Oracle Cloud** | Free Tier | ARM 4 OCPU, 24GB | $0 | Always Free |
| **Domain (ì„ íƒ)** | ~$12/year | 1ê°œ | ~$1/month | ì—†ì–´ë„ ë¬´ë°© |

**ë¹„ìš© ì‚°ì • ê³µì‹**:

ìˆ˜ì§‘ ë¹„ìš©:

$$
C_{\text{ingest}} = P \times C_{\text{storm}} + \frac{T_{\text{total}}}{1000} \times C_{\text{embed}}
$$

ì—¬ê¸°ì„œ:
- $P$ = ì´ í˜ì´ì§€ ìˆ˜ (~15,000)
- $C_{\text{storm}}$ = Storm Parse í˜ì´ì§€ë‹¹ ë¹„ìš© (~$0.01)
- $T_{\text{total}}$ = ì´ í† í° ìˆ˜ (~5M)
- $C_{\text{embed}}$ = OpenAI ì„ë² ë”© 1K í† í°ë‹¹ ë¹„ìš© ($0.00002)

ì›”ê°„ ìš´ì˜ ë¹„ìš©:

$$
C_{\text{monthly}} = Q_{\text{daily}} \times 30 \times T_q \times C_{\text{embed}} / 1000
$$

ì—¬ê¸°ì„œ:
- $Q_{\text{daily}}$ = ì¼ì¼ ê²€ìƒ‰ íšŸìˆ˜ (~100)
- $T_q$ = ì¿¼ë¦¬ë‹¹ í‰ê·  í† í° (~100)

### 6.2 Risk Register

| ID | Risk | Category | Impact | Likelihood | Score | Mitigation | Trigger |
|----|------|----------|--------|------------|-------|------------|---------|
| R1 | Storm Parse API ë¹„ìš© í­ì¦ | Cost | High | Low | ğŸŸ¡ | ì‚¬ì „ ë¹„ìš© ê³„ì‚°, Upstage ë°±ì—… | ì˜ˆìƒ ë¹„ìš© 2ë°° ì´ˆê³¼ ì‹œ |
| R2 | OpenAI API ê°€ê²© ì¸ìƒ | Cost | Medium | Medium | ğŸŸ¡ | ë¡œì»¬ ì„ë² ë”© ëª¨ë¸ ëŒ€ì•ˆ ì¤€ë¹„ | ê°€ê²© 50% ì´ìƒ ì¸ìƒ ì‹œ |
| R3 | PDF íŒŒì‹± í’ˆì§ˆ ì €í•˜ (ìŠ¤ìº” ìƒíƒœ) | Quality | High | Medium | ğŸŸ  | ìƒ˜í”Œ í…ŒìŠ¤íŠ¸ í›„ ì§„í–‰, ìˆ˜ë™ ë³´ì • | 10% ì´ìƒ íŒŒì‹± ì‹¤íŒ¨ ì‹œ |
| R4 | Oracle Free Tier ë¦¬ì†ŒìŠ¤ ì œí•œ | Infra | Medium | Low | ğŸŸ¢ | ì²­í¬ í¬ê¸° ìµœì í™”, ìŠ¤ì™‘ ì„¤ì • | ë©”ëª¨ë¦¬ 80% ì´ìƒ |
| R5 | í•œê¸€+ì½”ë“œ í˜¼í•© ì„ë² ë”© í’ˆì§ˆ | Quality | Medium | Medium | ğŸŸ¡ | ë‹¤êµ­ì–´ ëª¨ë¸ í‰ê°€, ì²­í¬ ì „ëµ ì¡°ì • | ê²€ìƒ‰ ê´€ë ¨ë„ 70% ë¯¸ë§Œ |
| R6 | Chroma DB í™•ì¥ì„± í•œê³„ | Infra | Low | Low | ğŸŸ¢ | ëª¨ë‹ˆí„°ë§, Qdrant ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš | 10ë§Œ ì²­í¬ ì´ˆê³¼ ì‹œ |
| R7 | ë°±ì—…/ë³µêµ¬ ì‹¤íŒ¨ | Data | High | Low | ğŸŸ¡ | ì£¼ê¸°ì  ë°±ì—… í…ŒìŠ¤íŠ¸, ë³µêµ¬ ì ˆì°¨ ë¬¸ì„œí™” | ì›” 1íšŒ ë³µêµ¬ í…ŒìŠ¤íŠ¸ |

**Risk Score ê³„ì‚°**:

$$
\text{Score} = \text{Impact} \times \text{Likelihood}
$$

| Score | Level | Action |
|-------|-------|--------|
| ğŸŸ¢ 1-3 | Low | ëª¨ë‹ˆí„°ë§ë§Œ |
| ğŸŸ¡ 4-6 | Medium | ëŒ€ì‘ ê³„íš ìˆ˜ë¦½ |
| ğŸŸ  7-9 | High | ì¦‰ì‹œ ëŒ€ì‘ í•„ìš” |

---

## 7. Stakeholders

| Role | Name | Responsibility |
|------|------|----------------|
| Product Owner | ë³¸ì¸ | ìš”êµ¬ì‚¬í•­ ì •ì˜, ìµœì¢… ìŠ¹ì¸ |
| Developer | ë³¸ì¸ | ì„¤ê³„, êµ¬í˜„, ë°°í¬ |
| End User | ë³¸ì¸ | ê²€ìƒ‰ ì‚¬ìš©, í”¼ë“œë°± |

---

## 8. Success Criteria

### MVP (v1.0) ì™„ë£Œ ì¡°ê±´
- [ ] ë³´ìœ  ì¥ì„œ ì „ì²´ ë²¡í„° DB ì ì¬ ì™„ë£Œ
- [ ] í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ ë™ì‘ í™•ì¸
- [ ] ê²€ìƒ‰ ê²°ê³¼ì— ì¶œì²˜(ì±…, í˜ì´ì§€) í‘œì‹œ
- [ ] Streamlit UI ì™¸ë¶€ ì ‘ì† ê°€ëŠ¥
- [ ] Oracle Cloud ì•ˆì • ìš´ì˜

### Quality Metrics with Measurement Plan

| Metric | Target | Measurement Method | Frequency |
|--------|--------|-------------------|-----------|
| ê²€ìƒ‰ ì‘ë‹µ ì‹œê°„ | < 2ì´ˆ (p95) | Streamlitì—ì„œ 100íšŒ ìš”ì²­, 95th percentile ì¸¡ì • | ë¦´ë¦¬ì¦ˆ ì‹œ |
| ê´€ë ¨ ê²°ê³¼ Top-5 í¬í•¨ìœ¨ | > 80% | ëŒ€í‘œ ì¿¼ë¦¬ 50ê°œë¡œ í‰ê°€, ìˆ˜ë™ ê´€ë ¨ì„± íŒì • | ë¦´ë¦¬ì¦ˆ ì‹œ |
| ì‹œìŠ¤í…œ ê°€ìš©ì„± | > 95% | UptimeRobot ë˜ëŠ” cron health check | ì›”ê°„ |
| ì‚¬ìš©ì ê²€ìƒ‰ ì‹œê°„ ì ˆê° | 5ë¶„ â†’ 30ì´ˆ | ìê°€ ì¸¡ì • (Before/After ë¹„êµ) | MVP ì™„ë£Œ í›„ |
| ì¬ê²€ìƒ‰ ì„±ê³µë¥  | > 90% | ì´ì „ì— ì°¾ì•˜ë˜ ë‚´ìš© ë‹¤ì‹œ ì°¾ê¸° ì„±ê³µ | 2ì£¼ ì‚¬ìš© í›„ |

**ëŒ€í‘œ ì¿¼ë¦¬ ì…‹ (Representative Query Set)**:
- `docs/prd.md` Section 11ì— 50ê°œ ì •ì˜

---

## 9. Document Parsing Strategy

### OCR vs Document Parsing

```mermaid
flowchart LR
    subgraph OCR["ğŸ“· Traditional OCR"]
        A1[Scanned PDF] --> A2[Raw Text]
        A2 --> A3["í”Œë«í•œ í…ìŠ¤íŠ¸\nêµ¬ì¡° ì—†ìŒ"]
    end

    subgraph DP["ğŸ“„ Document Parsing (Storm Parse)"]
        B1[Scanned PDF] --> B2[VLM Analysis]
        B2 --> B3["êµ¬ì¡°í™”ëœ ë§ˆí¬ë‹¤ìš´<br>â€¢ ì œëª©/ì„¹ì…˜<br>â€¢ ì½”ë“œ ë¸”ë¡<br>â€¢ í‘œ/ê°ì£¼"]
    end

    A3 -->|"âŒ ì²­í‚¹ ì–´ë ¤ì›€"| X[ë‚®ì€ RAG í’ˆì§ˆ]
    B3 -->|"âœ… ê¹”ë”í•œ ì²­í‚¹"| Y[ë†’ì€ RAG í’ˆì§ˆ]
```

### ì„ íƒ: Storm Parse API
- **ì´ìœ **: VLM ê¸°ë°˜ìœ¼ë¡œ ë ˆì´ì•„ì›ƒ + ì˜ë¯¸ ë¶„ì„
- **ì¥ì **: ì½”ë“œ ë¸”ë¡, í‘œ, ê°ì£¼ ìë™ ë¶„ë¦¬
- **ë°±ì—…**: Upstage Document AI

---

## Next Steps

1. PRD ìƒì„¸ ì‘ì„± â†’ `docs/prd.md`
2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ì„¤ê³„ â†’ `docs/architecture.md`
3. ê¸°ìˆ  ìŠ¤íƒ ê²°ì • â†’ `docs/tech-stack.md`
